<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="movements.pageTitle">Movimentações</title>

  <link rel="stylesheet" href="./css/estoque.css">
  <link rel="stylesheet" href="./css/movimentacoes.css">
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/popup.css">
  <link rel="stylesheet" href="./css/filtro.css">
  <link rel="stylesheet" href="./css/notificacoes.css">
  <link rel="shortcut icon" href="./icones/favicon.ico" type="image/x-icon">
</head>

<body>
  <nav class="navegacao reduzido">
    <img src="./img/seta-voltar.svg" alt="" class="navegacao-seta--voltar" />
    <div class="navegacao-logo">
      <a href="./index.html" class="navegacao-logo--voltar-login">
        <img src="./img/logo.png" alt="" class="navegacao-logo-img" />
      </a>
      <h3 class="navegacao-logo-titulo-">GreenMed<br />Solutions</h3>
    </div>
    <div class="navegacao-container">
      <ul class="navegacao-container--menu">
        <li>
          <a href="./estoque.html" data-i18n="nav.stock">
            <img src="./icones/estoque.svg" alt="" />
            Controle Estoque
          </a>
        </li>
        <li>
          <a href="./movimentacoes.html" data-i18n="nav.movements">
            <img src="./icones/movimentacoes.svg" alt="" />
            Movimentações
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container-conteudo-principal">
    <div class="container-conteudo-principal-cabecalho">
      <div class="titulo">
        <h1 data-i18n="movements.title">Movimentações</h1>
      </div>
      <div class="container-conteudo-principal-cabecalho--perfil">
        <div class="container">
          <div class="toggle-container">
            <div class="toggle-switch" id="themeToggle">
              <div class="toggle-slider">☀️</div>
            </div>
          </div>
        </div>
        <button id="btnNotificacoes" class="notif-btn-icon" aria-haspopup="dialog" aria-controls="notifPopover"
          aria-expanded="false" title="Abrir notificações">
          <svg width="32px" height="32px" stroke-width="1.5" viewBox="0 0 24 24" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M18.1336 11C18.7155 16.3755 21 18 21 18H3C3 18 6 15.8667 6 8.4C6 6.70261 6.63214 5.07475 7.75736 3.87452C8.88258 2.67428 10.4087 2 12 2C12.3373 2 12.6717 2.0303 13 2.08949"
              stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
            <path
              d="M19 8C20.6569 8 22 6.65685 22 5C22 3.34315 20.6569 2 19 2C17.3431 2 16 3.34315 16 5C16 6.65685 17.3431 8 19 8Z"
              stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
            <path
              d="M13.73 21C13.5542 21.3031 13.3019 21.5547 12.9982 21.7295C12.6946 21.9044 12.3504 21.9965 12 21.9965C11.6496 21.9965 11.3054 21.9044 11.0018 21.7295C10.6982 21.5547 10.4458 21.3031 10.27 21"
              stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
          <span id="notifBadge" class="notif-badge" aria-hidden="true">0</span>
        </button>

        <div class="container-conteudo-principal-cabecalho--perfil-user">
          <button id="btnProfile" class="profile-trigger-btn" aria-haspopup="dialog" aria-controls="profile-modal"
            aria-expanded="false" title="Abrir perfil">
            <svg class="profile" width="32px" height="32px" stroke-width="1.5" viewBox="0 0 24 24" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path d="M7 18V17C7 14.2386 9.23858 12 12 12V12C14.7614 12 17 14.2386 17 17V18" stroke="currentColor"
                stroke-width="1.5" stroke-linecap="round"></path>
              <path
                d="M12 12C13.6569 12 15 10.6569 15 9C15 7.34315 13.6569 6 12 6C10.3431 6 9 7.34315 9 9C9 10.6569 10.3431 12 12 12Z"
                stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5"></circle>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <div class="container-conteudo-principal--produtos">
      <div class="container-conteudo-principal--produtos-cabecalho">
        <h2 data-i18n="movements.title">Movimentações</h2>
        <div class="container-conteudo-principal--produtos-cabecalho-filtro">
          <button id="btnAbrirFiltro" class="flt-btn" type="button" title="Filtrar movimentações">
            <svg viewBox="0 0 24 24" aria-hidden="true" width="18" height="18">
              <path d="M4 6h16M7 12h10M10 18h4" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" />
            </svg>
            Filtro
          </button>

          <div class="container-conteudo-principal--produtos-cabecalho-filtro-pesquisa">
            <input type="search" class="container-conteudo-principal--produtos-cabecalho-filtro-pesquisa-btn-pesquisa"
              placeholder="Pesquisar..." />
            <img src="./img/search.svg" alt=""
              class="container-conteudo-principal--produtos-cabecalho-filtro-pesquisa-btn-pesquisa--search" />
          </div>

          <a href="#" id="novaMovimentacao"
            class="container-conteudo-principal--produtos-cabecalho-filtro--btn-novo-produto">
            Nova Movimentação
          </a>
        </div>
      </div>

      <div class="container-conteudo-principal--produtos-tabela">
        <table class="container-conteudo-principal--produtos--tabela--estoque">
          <thead>
            <tr>
              <th></th>
              <th class="tabela-titulo">ID</th>
              <th class="tabela-titulo">Data/Hora</th>
              <th class="tabela-titulo">Responsável</th>
              <th class="tabela-titulo">Produto</th>
              <th class="tabela-titulo">Quantidade</th>
              <th class="tabela-titulo">Status</th>
              <th class="tabela-titulo">Fornecedor</th>
              <th class="tabela-titulo">Observações</th>
              <th class="tabela-titulo">Ações</th>
            </tr>
          </thead>
          <tbody id="movimentacoesTabela">
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Profile Modal -->
  <div class="profile-backdrop" id="profile-modal" aria-hidden="true">
    <div class="profile-modal" role="dialog" aria-modal="true" aria-labelledby="profile-modal-title"
      aria-describedby="profile-modal-desc">
      <div class="profile-panel">
        <div class="profile-header">
          <h2 class="profile-title" id="profile-modal-title">Perfil</h2>
          <button class="profile-btn-secondary" id="profile-close" aria-label="Fechar">✕</button>
        </div>
        <div class="profile-body">
          <p id="profile-modal-desc" class="profile-help">
            Adicione uma foto e preencha seus dados para personalizar sua conta.
          </p>
          <form id="profileForm" novalidate>
            <div class="profile-grid">
              <div class="profile-avatar-uploader">
                <div class="profile-avatar-preview" id="avatarPreview">
                  <img id="avatarImg" alt="Pré-visualização da foto de perfil" src="/placeholder.svg"
                    style="display:none;" />
                  <svg id="avatarPh" xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                    aria-hidden="true">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                  </svg>
                </div>

                <div class="profile-avatar-actions">
                  <label for="avatarInput" class="profile-btn-secondary">Escolher foto</label>
                  <input id="avatarInput" class="profile-sr-only" type="file" accept="image/*" />
                  <button type="button" id="btnRemovePhoto" class="profile-btn-secondary">Remover</button>
                </div>

                <span class="profile-help">Formatos: JPG, PNG, WEBP. Recomenda-se imagem quadrada.</span>
              </div>

              <!-- Campos -->
              <div class="profile-fields">
                <div class="profile-field">
                  <label class="profile-label" for="username">Usuário *</label>
                  <input id="username" class="profile-input" name="username" type="text" placeholder="Usuário"
                    autocomplete="username" required />
                  <span class="profile-error" data-error-for="username"></span>
                </div>

                <div class="profile-two-cols">
                  <div class="profile-field">
                    <label class="profile-label" for="firstName">Nome</label>
                    <input id="firstName" class="profile-input" name="firstName" type="text" placeholder="Nome"
                      autocomplete="given-name" />
                  </div>
                  <div class="profile-field">
                    <label class="profile-label" for="lastName">Sobrenome</label>
                    <input id="lastName" class="profile-input" name="lastName" type="text" placeholder="Sobrenome"
                      autocomplete="family-name" />
                  </div>
                </div>

                <div class="profile-field">
                  <label class="profile-label" for="email">Email *</label>
                  <input id="email" class="profile-input" name="email" type="email" placeholder="voce@exemplo.com"
                    autocomplete="email" required />
                  <span class="profile-error" data-error-for="email"></span>
                </div>

                <div class="profile-field">
                  <label class="profile-label" for="birth">Data de Nascimento</label>
                  <input id="birth" class="profile-input" name="birth" type="date" />
                </div>
              </div>
            </div>
          </form>
        </div>

        <div class="profile-footer">
          <button class="profile-btn-secondary" id="profile-cancel">Cancelar</button>
          <button class="profile-btn-primary" id="profile-save">Salvar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="profile-toast" id="profile-toast" role="status" aria-live="polite" aria-atomic="true"></div>

  <!-- Popup Nova Movimentação -->
  <div id="popupNovaMovimentacao" class="popup" role="dialog" aria-modal="true" aria-hidden="true"
    style="display:none;">
    <div class="popup-content">
      <span class="close-btn" id="fecharPopupMov" aria-label="Fechar">×</span>
      <iframe src="./popup-movimentacao.html" width="100%" height="100%" title="Formulário de movimentação"></iframe>
    </div>
  </div>

  <!-- Filter Modal -->
  <div id="filtroBackdrop" class="flt-backdrop" aria-hidden="true"></div>
  <div id="filtroModal" class="flt-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="fltTitle">
    <div class="flt-card">
      <div class="flt-head">
        <div>
          <h2 id="fltTitle" class="flt-title">Filtrar movimentações</h2>
          <p id="fltDesc" class="flt-subtitle">Refine a lista pelos campos abaixo</p>
        </div>
        <button id="btnFiltroFecharX" class="flt-btn-icon" aria-label="Fechar filtro"
          style="padding: 8px; height: 32px; width: 32px;">
          <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
            <path d="M6 6l12 12M18 6L6 18" fill="none" stroke="currentColor" stroke-width="2" />
          </svg>
        </button>
      </div>

      <form id="filtroForm" class="flt-body">
        <div class="flt-field">
          <label for="fStatus" class="flt-label">Status</label>
          <select id="fStatus" name="status" class="flt-input">
            <option value="">Todos</option>
            <option value="entrada">Entrada</option>
            <option value="saida">Saída</option>
            <option value="transferencia">Transferência</option>
            <option value="ajuste">Ajuste</option>
          </select>
        </div>

        <div class="flt-field">
          <label for="fProduto" class="flt-label">Produto</label>
          <div style="position: relative;">
            <input id="fProduto" name="produto" class="flt-input" type="text"
              placeholder="Digite o nome ou ID do produto" autocomplete="off" />
            <div id="fProdutoDropdown" class="produto-dropdown" style="display: none;"></div>
          </div>
        </div>

        <div class="flt-field">
          <label for="fResponsavel" class="flt-label">Responsável</label>
          <div style="position: relative;">
            <input id="fResponsavel" name="responsavel" class="flt-input" type="text"
              placeholder="Digite o nome do responsável" autocomplete="off" />
            <div id="fResponsavelDropdown" class="produto-dropdown" style="display: none;"></div>
          </div>
        </div>

        <div class="flt-field">
          <label for="fFornecedor" class="flt-label">Fornecedor</label>
          <div style="position: relative;">
            <input id="fFornecedor" name="fornecedor" class="flt-input" type="text"
              placeholder="Digite o nome do fornecedor" autocomplete="off" />
            <div id="fFornecedorDropdown" class="produto-dropdown" style="display: none;"></div>
          </div>
        </div>
      </form>

      <div class="flt-foot">
        <button id="btnFiltroLimpar" class="flt-btn-ghost" type="button">Limpar</button>
        <div class="flt-foot-right">
          <button id="btnFiltroCancelar" class="flt-btn-ghost" type="button">Cancelar</button>
          <button id="btnFiltroAplicar" class="flt-btn-primary" type="button">Aplicar filtros</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="./js/script.js" defer></script>
  <script type="module" src="./js/modo-escuro.js"></script>
  <script type="module" src="./js/perfil.js"></script>
  <script type="module" src="./js/movimentacoes.js"></script>
  <script type="module" src="./js/filtro-movimentacoes.js"></script>
  <script src="./js/i18n.js" defer></script>
</body>

</html>
